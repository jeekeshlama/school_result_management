
@model FiboOffice.Src.ViewModel.BranchViewModel
@{ Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Index";
    int SN = 1;
}
@inject FiboOffice.InfraStructure.Repository.IOfficeRepository _officeRepo;
@inject FiboAddress.InfraStructure.Repository.IProvienceRepository _provienceRepo;
@inject FiboAddress.InfraStructure.Repository.IDistrictRepository _districtRepo;
@inject FiboAddress.InfraStructure.Repository.ILocalLevelRepository _localLevelRepo;



<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="breadcome-list">
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                            <div class="breadcome-heading">

                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                            <ul class="breadcome-menu">
                                <li>
                                    <a href="#">Home</a> <span class="bread-slash">/</span>
                                </li>
                                <li>
                                    <span class="bread-blod">Branch </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sparkline13-list">
            <div class="sparkline13-hd">
                <div class="main-sparkline13-hd">
                    <h1>Local <span class="table-project-n">Level</span>List</h1>
                </div>
            </div>
            <div class="sparkline13-graph">
                <div class="datatable-dashv1-list custom-datatable-overright">
                    <div id="toolbar">
                        <select class="form-control dt-tb">
                            <option value="">Export Basic</option>
                            <option value="all">Export All</option>
                            <option value="selected">Export Selected</option>
                        </select>
                    </div>
                    <div class="add-product">
                        <button data-toggle="modal" BranchId="0" data-target="#myModal" class="pd-setting-ed" style="float:right;margin-top:-30px;"><i class="fa fa-plus" data-toggle="tooltip" title="Add" aria-hidden="true">Add Add Branch</i></button>
                    </div>
                    <table id="table" data-toggle="table" data-pagination="true" data-search="true" data-show-columns="true" data-show-pagination-switch="true" data-show-refresh="true" @*data-key-events="true" data-show-toggle="true" data-resizable="true" data-cookie="true"*@
                           data-cookie-id-table="saveId" data-show-export="true" data-click-to-select="true" data-toolbar="#toolbar">
                        <thead>
                            <tr>
                                <th>S.N</th>
                                <th>Name</th>
                                <th>Phone Number</th>
                                <th>E-mail Address</th>
                                <th>Ward Number</th>
                                <th>LocalLevel</th>
                                <th>District</th>
                                <th>provience</th>
                                <th>Office</th>

                                <th style="text-align:center;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Branches)
                            {
                                var district = await _districtRepo.GetByIdAsync(item.DistrictId.Value);
                                var localLevel = await _localLevelRepo.GetByIdAsync(item.LocalLevelId.Value);
                                var provience = await _provienceRepo.GetByIdAsync(item.ProvienceId.Value);
                                var office = await _officeRepo.GetByIdAsync(item.DistrictId.Value);

                            <tr>
                                <td>
                                    @SN
                                </td>
                                <td>
                                    @item.Name
                                </td>
                                <td>
                                    @item.PhoneNo
                                </td>
                                <td>
                                    @item.Email
                                </td>
                                <td>
                                    @item.WardNo
                                </td>
                                <td>
                                    @if (localLevel != null)
                                    {
                                        @localLevel.Name
                                    }
                                </td>
                                <td>
                                    @if (district != null)
                                    {
                                        @district.Name
                                    }
                                </td>
                                <td>
                                    @if (provience != null)
                                    {
                                        @provience.Name
                                    }
                                </td>
                                <td>
                                    @if (office != null)
                                    {
                                        @office.Name
                                    }
                                </td>
                                <td>
                                    <button ReferenceType="Crud" data-toggle="modal" BranchId="@item.Id" data-target="#myModal" class="pd-setting-ed"><i class="fa fa-pencil-square-o" data-toggle="tooltip" title="Edit" aria-hidden="true"></i></button>
                                    <button data-toggle="modal" ="@item.Id" data-target="#myModal" class="pd-setting-ed"><i class="fa fa-trash" data-toggle="tooltip" title="Trash" aria-hidden="true"></i></button>
                                </td>
                            </tr>
                                SN++;
                            }
                        </tbody>
                    </table>
                </div>
                <div class="custom-pagination">
                    <nav aria-label="Page navigation example">
                        <ul class="pagination">
                            <li class="page-item"><a class="page-link" href="#">Previous</a></li>
                            <li class="page-item"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item"><a class="page-link" href="#">Next</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="~/lib/jquery/dist/jquery.min.js"></script>
@section Scripts
    {
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
    <script type="text/javascript">
            $("#myModal").on('show.bs.modal', function (ke
            ) {
                const BranchId = $(ke.relatedTarget).attr('BranchId');

                var url = '@Url.Action("Delete","Branch")' + "?id=" + BranchId;
                if (BranchId > 0) {
                $("#DeleteBody").load(url, function () {

                    $("#myModal").modal('show');
                });
            }
            else {
                $("#myModal").modal('hide');
            }
        })
    </script>
}
@if (ViewBag.Message != null)
{
    <script type="text/javascript">
    'use strict';
    $(window).on('load', function () {
        function notify(message,type) {
            $.growl({
                message: message
            }, {
                type: type,
                allow_dismiss: false,
                label: 'Cancel',
                className: 'btn-xs btn-inverse',
                placement: {from: 'top', align: 'right'},
                delay: 2500,
                animate: { enter: 'animated rotateIn', exit: 'animated rotateIn'},
                offset: {x: 30,y: 30}
            });
        };
        notify('@ViewBag.Message','success');
    });
    </script>
}



@if (ViewBag.Messege != null)
{
    <script type="text/javascript">
    'use strict';
    $(window).on('load', function () {
        function notify(messege,type) {
            $.growl({
                message: messege
            }, {
                type: type,
                allow_dismiss: false,
                label: 'Cancel',
                className: 'btn-xs btn-inverse',
                placement: {from: 'top', align: 'right'},
                delay: 2500,
                animate: { enter: 'animated rotateIn', exit: 'animated rotateIn'},
                offset: {x: 30,y: 30}
            });
        };
        notify('@ViewBag.Messege','danger');
    });
    </script>
}

